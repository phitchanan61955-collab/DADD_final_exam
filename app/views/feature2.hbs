<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>{{title}}</title>

  <!-- Bootstrap -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">

  <style>
    .page-wrap { max-width: 1080px; }
    .table thead th { position: sticky; top: 0; z-index: 1; }
    .dadd-zero { opacity: .65; }
    .mono { font-variant-numeric: tabular-nums; }
  </style>
</head>

<body class="bg-light">

  <!-- Top bar -->
  <nav class="navbar navbar-expand-lg navbar-dark bg-dark">
    <div class="container-fluid">
      <a class="navbar-brand fw-semibold" href="/">DADD Dashboard</a>
      <div class="ms-auto">
        <a href="/" class="btn btn-outline-light btn-sm">‚Üê Back to Home</a>
      </div>
    </div>
  </nav>

  <main class="container page-wrap py-4">

    <!-- Header -->
    <div class="d-flex flex-column flex-md-row align-items-md-end justify-content-between gap-2 mb-3">
      <div>
        <h1 class="h4 mb-1"> Sub-Region &amp; Decade</h1>
        <p class="text-muted small mb-0">
          Select a sub-region and a decade to list all countries with their DADD (sorted by DADD ascending).
        </p>
      </div>

      {{#if selectedSubRegion}}
        <div class="text-md-end">
          <div class="d-flex flex-wrap gap-2 justify-content-md-end"> 
            {{#if selectedDecade}}
              
            {{/if}}
          </div>
        </div>
      {{/if}}
    </div>

    <!-- Filter Card -->
    <div class="card border-0 shadow-sm mb-3">
      <div class="card-body">
        <div class="d-flex align-items-center justify-content-between mb-2">
          <div class="fw-semibold">Filter</div>
          <span class="badge rounded-pill text-bg-info">ASC by DADD</span>
        </div>

        <form method="get" action="/feature2" class="row g-2 align-items-end">

          <!-- Sub-region -->
          <div class="col-12 col-md-6 col-lg-5">
            <label class="form-label small mb-1" for="sub_region_id">Sub-Region</label>
            <select class="form-select form-select-sm" name="sub_region_id" id="sub_region_id" required>
              <option value="">-- Select sub-region --</option>
              {{#each subregions}}
                <option value="{{this.sub_region_id}}"
                  {{#ifEquals this.sub_region_id ../selectedSubRegion}}selected{{/ifEquals}}>
                  {{this.sub_region_name}} 
                </option>
              {{/each}}
            </select>
          </div>

          <!-- Decade -->
          <div class="col-12 col-md-6 col-lg-4">
            <label class="form-label small mb-1" for="decade">Decade</label>
            <select class="form-select form-select-sm" name="decade" id="decade" required>
              <option value="">-- Select decade --</option>
              {{#each decades}}
                <option value="{{this.decade_id}}"
                  {{#ifEquals this.decade_id ../selectedDecade}}selected{{/ifEquals}}>
                  {{this.decade_id}}
                </option>
              {{/each}}
            </select>
          </div>

          <!-- Actions -->
          <div class="col-12 col-lg-3 d-flex gap-2">
            <button class="btn btn-primary btn-sm w-100" type="submit">
              Show Results
            </button>
            <a class="btn btn-outline-secondary btn-sm w-100" href="/feature2">
              Reset
            </a>
          </div>

        </form>
      </div>
    </div>

    <!-- Results -->
    <div class="card border-0 shadow-sm">
      <div class="card-body">

        <div class="d-flex flex-column flex-md-row align-items-md-center justify-content-between gap-2 mb-2">
          <div class="fw-semibold">Results</div>

          {{#if results.length}}
            <div class="small text-muted">
              Showing <span class="fw-semibold">{{results.length}}</span> countries
            </div>
          {{/if}}
        </div>

        {{#if results.length}}
          <div class="table-responsive">
            <table class="table table-sm table-striped table-hover align-middle mb-0">
              <thead class="table-light">
                <tr>
                  <th style="min-width: 260px;">Country</th>
                  <th class="text-center" style="width: 90px;">Decade</th>
                  <th class="text-end" style="width: 120px;">DADD</th>
                </tr>
              </thead>
              <tbody class="mono">
                {{#each results}}
                  <tr class="{{#ifEquals this.dadd_value 0}}dadd-zero{{/ifEquals}}">
                    <td>
                      <div class="fw-semibold">{{this.country_name}}</div>
                      <div class="text-muted small">{{this.sub_region_name}}</div>
                    </td>
                    <td class="text-center">{{this.decade_id}}</td>
                    <td class="text-end">
                      <span class="badge text-bg-light border">
                        {{this.dadd_value}}
                      </span>
                    </td>
                  </tr>
                {{/each}}
              </tbody>
            </table>
          </div>
        {{else}}
          <div class="alert alert-warning mb-0">
            No data for this Sub-Region &amp; Decade. Try another combination.
          </div>
        {{/if}}

      </div>
    </div>

  </main>

</body>
</html>
